!function(){"use strict";async function t(t,e){try{const n=function(){const t=localStorage.getItem("copilot_settings");return t&&JSON.parse(t).serviceToken||""}();if(!n)return"Ошибка: Не указан сервисный токен. Настройте плагин на панели DC Expert.";const r=[{role:"system",content:"Ты — DC Expert, профессиональный ассистент Excel. \nТвоя задача: предоставлять краткие, точные и полезные ответы на запросы пользователя по данным из ячеек.\nСТРОГИЕ ПРАВИЛА:\n1. Выдавай ТОЛЬКО результат без лишних слов, приветствий и пояснений.\n2. КАТЕГОРИЧЕСКИ ЗАПРЕЩЕНО использовать разметку Markdown (бектики `, звездочки *, решетки #).\n3. Весь текст должен быть простым и чистым, чтобы его можно было сразу использовать в Excel.\n4. Ответ должен быть на русском языке."},{role:"user",content:`Данные из ячеек: ${JSON.stringify(t)}\n\nЗапрос: ${e}`}],s=await fetch("https://excelprx.hsecontest.ru/api/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({messages:r,stream:!1})});if(!s.ok)return`Ошибка: ${(await s.json().catch(()=>({}))).error||s.statusText}`;const o=await s.json();return o.choices?.[0]?.message?.content?.trim()||"Пустой ответ от сервера."}catch(t){return console.error("Error in dcexpert:",t),`Ошибка: ${t instanceof Error?t.message:"Неизвестная ошибка"}`}}CustomFunctions.associate("DCEXPERT",t),CustomFunctions.associate("DCEXPERT",t)}();
//# sourceMappingURL=custom-functions.js.map